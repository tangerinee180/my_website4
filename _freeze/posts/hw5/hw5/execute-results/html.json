{
  "hash": "c7bac1a27154bacda8f367260e8adc1f",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"hw5\"\njupyter: python3\n---\n\n::: {#0d7faaf8 .cell execution_count=1}\n``` {.python .cell-code}\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns    \nimport matplotlib.pyplot as plt    \nimport math\nfrom scipy.stats import norm\n\nraw_welfare = pd.read_spss(\"../../Koweps_hpwc14_2019_beta2.sav\")\n\nwelfare = raw_welfare.copy()\n\n\nwelfare.describe()\n\nwelfare.rename(columns = {\n        \"h14_g3\"    : \"sex\",\n        \"h14_g4\"    : \"birth\",\n        \"h14_g10\"   : \"marriage_type\",\n        \"h14_g11\"   : \"religion\",\n        \"p1402_8aq1\": \"income\",\n        \"h14_eco9\"  : \"code_job\",\n        \"h14_reg7\"  : \"code_region\"},inplace = True)\n\nwelfare = welfare[[\"sex\",\"birth\",\"marriage_type\",\\\n\"religion\",\"income\",\"code_job\",\"code_region\"]]\n\nwelfare.shape\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```\n(14418, 7)\n```\n:::\n:::\n\n\n::: {#1aad1354 .cell execution_count=2}\n``` {.python .cell-code}\nwelfare[\"sex\"].dtypes\nwelfare.loc[0,\"sex\"] = 2.0\nwelfare[\"sex\"].value_counts()\n\n\n\nwelfare[\"sex\"] = np.where(welfare[\"sex\"]==1,\"male\",\"female\")\nwelfare[\"sex\"].value_counts()\n\nwelfare[\"income\"].describe()\nwelfare[\"income\"].isna().sum()\nwelfare[\"income\"].sum()\nsex_income = welfare.dropna(subset=\"income\").groupby(\"sex\",as_index=False).agg(mean_income=(\"income\",\"mean\"))\n\nsex_income\n\nsns.barplot(data=sex_income,x=\"sex\",y=\"mean_income\",hue='sex')\n\nplt.show()\nplt.clf()\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-3-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n## #숙제: 위 그래프에서 각 성별 95% 신뢰 구간 계산 후 그리기\n\n::: {#e54b94e5 .cell execution_count=3}\n``` {.python .cell-code}\ntemp = welfare.dropna(subset=\"income\").groupby(\"sex\",as_index=False).agg(mean_income=(\"income\",\"mean\"),\n                                                                              var_income =(\"income\",'var'),\n                                                                              len_income =(\"income\",\"count\"))\n\ntemp[\"left_ci\"]= temp['mean_income'] - norm.ppf(0.975,0,1)*np.sqrt(temp['var_income']/(temp[\"len_income\"]))\ntemp[\"right_ci\"]= temp['mean_income'] + norm.ppf(0.975,0,1)*np.sqrt(temp['var_income']/(temp[\"len_income\"]))\ntemp\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sex</th>\n      <th>mean_income</th>\n      <th>var_income</th>\n      <th>len_income</th>\n      <th>left_ci</th>\n      <th>right_ci</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>female</td>\n      <td>186.293096</td>\n      <td>17439.157372</td>\n      <td>2245</td>\n      <td>180.830455</td>\n      <td>191.755737</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>male</td>\n      <td>349.037571</td>\n      <td>47463.961875</td>\n      <td>2289</td>\n      <td>340.112592</td>\n      <td>357.962550</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n# plt.plot 이용\n\n::: {#90adb8a0 .cell execution_count=4}\n``` {.python .cell-code}\nsns.barplot(data=sex_income,x=\"sex\",y=\"mean_income\",hue='sex')\nplt.plot([0, 0], [temp.iloc[0][\"left_ci\"], temp.iloc[0][\"right_ci\"]], color='black', linewidth=2)\nplt.plot([1, 1], [temp.iloc[1][\"left_ci\"], temp.iloc[1][\"right_ci\"]], color='black', linewidth=2)\nplt.show()\nplt.clf()\n\n```\n\n::: {.cell-output .cell-output-display}\n![](hw5_files/figure-html/cell-5-output-1.png){width=593 height=429}\n:::\n\n::: {.cell-output .cell-output-display}\n```\n<Figure size 672x480 with 0 Axes>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "hw5_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}